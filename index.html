<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô - PROMED MEDICAL LICENSE</title>
    
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f0f2f5; }
        .text-promed { color: #8DC63F; }
        .bg-promed { background-color: #8DC63F; }
        .btn-promed:hover { background-color: #7ab332; }
        
        /* Loading Spinner */
        .loader {
            border: 3px solid #f3f3f3;
            border-radius: 50%;
            border-top: 3px solid #8DC63F;
            width: 20px;
            height: 20px;
            -webkit-animation: spin 1s linear infinite;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen pb-10 relative">

    <div id="pdpaModal" class="fixed inset-0 bg-gray-900 bg-opacity-90 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl max-w-sm w-full overflow-hidden">
            <div class="p-5 border-b border-gray-100">
                <h2 class="text-lg font-bold text-gray-800 flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-promed" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                    </svg>
                    ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•
                </h2>
            </div>
            
            <div class="p-5">
                <div class="text-sm text-gray-600 mb-4 h-40 overflow-y-auto border rounded-lg p-3 bg-gray-50 leading-relaxed">
                    <p class="font-bold mb-2">‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß (PDPA)</p>
                    <p class="mb-2">PROMED MEDICAL LICENSE ("‡πÄ‡∏£‡∏≤") ‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™ ‡πÄ‡∏£‡∏≤‡∏Ç‡∏≠‡πÅ‡∏à‡πâ‡∏á‡πÉ‡∏´‡πâ‡∏ó‡∏£‡∏≤‡∏ö‡∏ß‡πà‡∏≤:</p>
                    <ul class="list-disc pl-4 space-y-1 mb-2">
                        <li>‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô (‡∏ä‡∏∑‡πà‡∏≠, ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£, ‡πÑ‡∏•‡∏ô‡πå‡πÑ‡∏≠‡∏î‡∏µ ‡∏Ø‡∏•‡∏Ø) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏á‡∏≤‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</li>
                        <li>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÑ‡∏ß‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏ï‡πà‡∏≠‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á</li>
                        <li>‡∏ó‡πà‡∏≤‡∏ô‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢</li>
                    </ul>
                    <p>‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ó‡πà‡∏≤‡∏ô‡∏Å‡∏î "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô" ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏ó‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö‡πÅ‡∏•‡∏∞‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô</p>
                </div>

                <label class="flex items-start space-x-3 cursor-pointer">
                    <input type="checkbox" id="pdpaCheckbox" class="mt-1 w-5 h-5 text-green-600 rounded border-gray-300 focus:ring-green-500">
                    <span class="text-sm text-gray-700 select-none">‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö <b class="text-gray-900">‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</b> ‡πÅ‡∏•‡∏∞‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</span>
                </label>
            </div>

            <div class="p-5 border-t border-gray-100 bg-gray-50">
                <button id="pdpaBtn" disabled class="w-full bg-gray-300 text-white font-bold py-3 rounded-xl transition-all duration-300 cursor-not-allowed">
                    ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠
                </button>
            </div>
        </div>
    </div>

    <div class="max-w-md mx-auto bg-white min-h-screen shadow-xl relative">
        
        <div class="bg-white p-6 text-center border-b border-gray-100 sticky top-0 z-20 shadow-sm">
            <div class="h-28 w-full flex items-center justify-center mb-2">
                <img id="logoImg" src="" alt="PROMED Logo" class="h-full w-auto object-contain">
            </div>
            <h1 class="text-xl font-bold text-gray-800">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1>
            <p class="text-promed font-medium text-sm">PROMED MEDICAL LICENSE</p>
        </div>

        <div class="px-6 pt-6">
            <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg">
                <p class="text-sm text-yellow-700">
                    ‚ö†Ô∏è <b>‡∏£‡∏±‡∏ö‡πÄ‡∏û‡∏µ‡∏¢‡∏á 5 ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á/‡∏£‡∏≠‡∏ö</b> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡πá‡∏≠‡∏Ñ‡∏ï‡∏≤‡∏£‡∏≤‡∏á
                </p>
            </div>
        </div>

        <form id="regisForm" class="p-6 space-y-4">
            <input type="hidden" id="userId" name="userId">
            
            <div class="space-y-3">
                <h3 class="text-xs font-bold text-gray-400 uppercase tracking-wider border-b pb-1">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
                <div>
                    <label class="block text-sm font-medium text-gray-700">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• (‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô) <span class="text-red-500">*</span></label>
                    <input type="text" id="fullname" required class="w-full border-gray-300 border p-2.5 rounded-lg mt-1 focus:outline-none focus:ring-2 focus:ring-[#8DC63F]" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏à‡∏£‡∏¥‡∏á">
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô <span class="text-red-500">*</span></label>
                        <input type="text" id="nickname" required class="w-full border-gray-300 border p-2.5 rounded-lg mt-1 focus:ring-2 focus:ring-[#8DC63F]">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">‡∏≠‡∏≤‡∏¢‡∏∏</label>
                        <input type="number" id="age" class="w-full border-gray-300 border p-2.5 rounded-lg mt-1 focus:ring-2 focus:ring-[#8DC63F]">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô / ‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢ <span class="text-red-500">*</span></label>
                    <input type="text" id="education" required class="w-full border-gray-300 border p-2.5 rounded-lg mt-1 focus:ring-2 focus:ring-[#8DC63F]" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÅ‡∏û‡∏ó‡∏¢‡πå ‡∏õ‡∏µ 4 ‡∏°.‡∏°‡∏´‡∏¥‡∏î‡∏•">
                </div>
            </div>

            <div class="space-y-3 pt-2">
                <h3 class="text-xs font-bold text-gray-400 uppercase tracking-wider border-b pb-1">‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</h3>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Email <span class="text-red-500">*</span></label>
                    <input type="email" id="email" required class="w-full border-gray-300 border p-2.5 rounded-lg mt-1 focus:ring-2 focus:ring-[#8DC63F]">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Line ID <span class="text-red-500">*</span></label>
                    <input type="text" id="lineId" required class="w-full border-gray-300 border p-2.5 rounded-lg mt-1 focus:ring-2 focus:ring-[#8DC63F]">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå (‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô) <span class="text-red-500">*</span></label>
                    <input type="tel" id="phoneStudent" required class="w-full border-gray-300 border p-2.5 rounded-lg mt-1 focus:ring-2 focus:ring-[#8DC63F]" placeholder="0xx-xxx-xxxx">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå (‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á)</label>
                    <input type="tel" id="phoneParent" class="w-full border-gray-300 border p-2.5 rounded-lg mt-1 focus:ring-2 focus:ring-[#8DC63F]" placeholder="0xx-xxx-xxxx">
                </div>
            </div>

            <div class="space-y-3 pt-2">
                <h3 class="text-xs font-bold text-gray-400 uppercase tracking-wider border-b pb-1">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
                <div>
                    <label class="block text-sm font-medium text-gray-700">‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏á <span class="text-red-500">*</span></label>
                    <select id="subject" class="w-full border-gray-300 border p-2.5 rounded-lg mt-1 bg-white focus:ring-2 focus:ring-[#8DC63F]">
                        <option value="NL1">NL1 (Comprehensive)</option>
                        <option value="NL2">NL2 (Clinical Science)</option>
                        <option value="NL3_MEQ">NL3 (MEQ)</option>
                        <option value="NL3_OSCE">NL3 (OSCE)</option>
                        <option value="Anatomy">Anatomy</option>
                        <option value="Dental">‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                    <textarea id="preferredTime" rows="2" class="w-full border-gray-300 border p-2.5 rounded-lg mt-1 focus:ring-2 focus:ring-[#8DC63F]" placeholder="‡πÄ‡∏ä‡πà‡∏ô 20 ‡∏ä‡∏°. ‡∏™‡∏∞‡∏î‡∏ß‡∏Å ‡∏à-‡∏® ‡∏´‡∏•‡∏±‡∏á 18.00"></textarea>
                </div>
            </div>

            <div class="pt-4 pb-8">
                <button type="submit" id="submitBtn" class="w-full bg-promed text-white font-bold py-4 rounded-xl shadow-lg hover:bg-[#7ab332] transition duration-300 flex justify-center items-center gap-2">
                    <span>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>
                    <div id="loadingSpinner" class="loader hidden"></div>
                </button>
            </div>
        </form>
    </div>

    <script>
        // ==========================================
        // ‚öôÔ∏è CONFIG (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö)
        // ==========================================
        const LIFF_ID = '2009152707-JaNVAeT8'; 
        const GAS_URL = 'https://script.google.com/macros/s/AKfycbxW67nhUDRyDYOGxG8z0pImA00vOkJ81iF1_yVMFpuWR1XdoL5z9mIsIcbhJ-K1bbbC/exec';
        
        // üü¢ ID ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏™‡πà‡∏á‡∏°‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
        const LOGO_FILE_ID = '1F3_t5Tk8WfdHu1domWwrEg6JTShR5dmp'; 

        // ==========================================
        // üõ°Ô∏è PDPA Logic
        // ==========================================
        const pdpaModal = document.getElementById('pdpaModal');
        const pdpaCheckbox = document.getElementById('pdpaCheckbox');
        const pdpaBtn = document.getElementById('pdpaBtn');

        pdpaCheckbox.addEventListener('change', function() {
            if (this.checked) {
                pdpaBtn.disabled = false;
                pdpaBtn.classList.remove('bg-gray-300', 'cursor-not-allowed');
                pdpaBtn.classList.add('bg-promed', 'hover:bg-[#7ab332]', 'shadow-lg');
            } else {
                pdpaBtn.disabled = true;
                pdpaBtn.classList.add('bg-gray-300', 'cursor-not-allowed');
                pdpaBtn.classList.remove('bg-promed', 'hover:bg-[#7ab332]', 'shadow-lg');
            }
        });

        pdpaBtn.addEventListener('click', function() {
            // ‡∏ã‡πà‡∏≠‡∏ô Modal ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
            pdpaModal.classList.add('hidden');
        });

        // ==========================================
        // üñºÔ∏è Logo & LIFF Logic
        // ==========================================
        function setLogo() {
            const imgElement = document.getElementById('logoImg');
            if(LOGO_FILE_ID) {
                imgElement.src = `https://drive.google.com/thumbnail?id=${LOGO_FILE_ID}&sz=w1000`; 
            }
        }

        async function main() {
            setLogo();
            try {
                await liff.init({ liffId: LIFF_ID });
                if (liff.isLoggedIn()) {
                    const profile = await liff.getProfile();
                    document.getElementById('userId').value = profile.userId;
                    document.getElementById('lineId').value = profile.displayName;
                } else {
                    liff.login();
                }
            } catch (err) {
                console.error("LIFF Error:", err);
            }
        }
        main();

        document.getElementById('regisForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const btn = document.getElementById('submitBtn');
            const spinner = document.getElementById('loadingSpinner');
            const btnText = btn.querySelector('span');
            
            btn.disabled = true;
            btnText.innerText = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';
            spinner.classList.remove('hidden');

            const formData = {
                userId: document.getElementById('userId').value,
                fullname: document.getElementById('fullname').value,
                nickname: document.getElementById('nickname').value,
                age: document.getElementById('age').value,
                education: document.getElementById('education').value,
                email: document.getElementById('email').value,
                lineId: document.getElementById('lineId').value,
                phoneStudent: document.getElementById('phoneStudent').value,
                phoneParent: document.getElementById('phoneParent').value,
                subject: document.getElementById('subject').value,
                hours: "-",
                preferredTime: document.getElementById('preferredTime').value
            };

            try {
                await fetch(GAS_URL, {
                    method: 'POST',
                    body: JSON.stringify(formData),
                    mode: 'no-cors'
                });

                Swal.fire({
                    title: '‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                    text: '‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤‡πÉ‡∏´‡πâ‡∏ó‡∏≤‡∏á‡πÑ‡∏•‡∏ô‡πå‡∏Ñ‡∏£‡∏±‡∏ö',
                    icon: 'success',
                    confirmButtonColor: '#8DC63F',
                    confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á'
                }).then(() => {
                    liff.closeWindow();
                });

            } catch (err) {
                console.error(err);
                Swal.fire('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á', 'error');
                btn.disabled = false;
                btnText.innerText = '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô';
                spinner.classList.add('hidden');
            }
        });
    </script>
</body>
</html>
